<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="../public/stylesheets/screen.css">
    <style>

        #tabs {
            margin-top: 1em;
        }

        #tabs li .ui-icon-close {
            float: left;
            margin: 0.4em 0.2em 0 0;
            cursor: pointer;
        }

    </style>
    <script>
        $(function () {
            var tabTitle = $("#tab_title"),
                    tabContent = $("#tab_content"),
                    tabTemplate = "<li><a href='#{href}'>#{li}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>",
                    tabCounter = 2;

            var tabs = $("#tabs").tabs();


            var label = tabTitle.val(),
                    id = "tabs-" + tabCounter,
                    li = $(tabTemplate.replace(/#\{href\}/g, "#" + id).replace(/#\{label\}/g, label)),
                    tabContentHtml = tabContent.val();

            tabs.find(".ui-tabs-nav").append(li);
            tabs.append("<div id='" + id + "'><p>" + tabContentHtml + "</p></div>");
            tabs.tabs("refresh");
            tabCounter++;
            event.preventDefault();


            // close icon: removing the tab on click
            tabs.delegate("span.ui-icon-close", "click", function () {
                var panelId = $(this).closest("li").remove().attr("aria-controls");
                $("#" + panelId).remove();
                tabs.tabs("refresh");
            });

            tabs.bind("keyup", function (event) {
                if (event.altKey && event.keyCode === $.ui.keyCode.BACKSPACE) {
                    var panelId = tabs.find(".ui-tabs-active").remove().attr("aria-controls");
                    $("#" + panelId).remove();
                    tabs.tabs("refresh");
                }
            });
        });
    </script>
</head>
<body>

<form action="/create" method="post" accept-charset="utf-8">
    <div>
        <input type="text" name="lesson"/>
        <input type="datetime-local" name="time"/>
        <input type="text" name="trainer"/>
        <input type="number" name="price"/>
        <input id="add" type="submit"/>
    </div>
</form>

<% todos.forEach( function (todo){ %>
<div id="tabs">
    <ul>
        <li>

            <a href="#tab_content"><%= todo._id %> <%= todo.count %></a>

        </li>
    </ul>
    <table class="table">

        <% todo.books.forEach(function(t){ %>
        <div id="tab_content">
            <tr>

                <td>

                    <%= t.lesson %><%= t.time %><%= t.trainer %><%= t.price %>
                    <a class="del-btn" href="/destroy/<%= t._id %>" title="Delete this todo item">Delete</a>
                </td>

            </tr>
        </div>
        <% }); %>
    </table>

</div>

<% }); %>

</body>
</html>